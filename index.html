<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¼ì¼ì¬ê³ í˜„í™©í‘œ - ë„í˜•ë³„ ìƒ‰ìƒ ê³ ì • ë²„ì „</title>
    <style>
        /* [ê¸°ì¡´ ë””ìì¸ ë° ë ˆì´ì•„ì›ƒ ìœ ì§€ - ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€] */
        body { font-family: 'Malgun Gothic', sans-serif; display: flex; flex-direction: column; align-items: center; padding: 50px; background-color: #f8f9fa; }
        h1 { text-decoration: underline; font-size: 38px; margin-bottom: 70px; letter-spacing: 15px; font-weight: bold; color: #222; }
        .grid-container { display: grid; grid-template-columns: repeat(7, 110px); grid-template-rows: repeat(2, 130px); position: relative; border: 2px solid #333; background-color: #fff; }
        
        /* ë„í˜• ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .rect { border: 0.5px solid #000; display: flex; flex-direction: column; justify-content: center; align-items: center; font-weight: bold; z-index: 1; transition: all 0.25s ease-in-out; }
        .circle { position: absolute; width: 95px; height: 95px; border: 1px solid #000; border-radius: 50%; background-color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; transform: translate(-50%, -50%); transition: all 0.25s ease-in-out; }
        
        /* [í•µì‹¬ ìˆ˜ì •] ë„í˜•ë³„ ê¸€ì ìƒ‰ìƒ ê³ ì • */
        .circle .code { color: #0000FF !important; } /* ì›í˜• ë‚´ë¶€ ê¸€ì: íŒŒë€ìƒ‰ */
        .rect .code { color: #C55A11 !important; }   /* ì‚¬ê°í˜• ë‚´ë¶€ ê¸€ì: ì£¼í™©ìƒ‰ */
        
        .green-pos { color: #70AD47; font-size: 11px; margin-top: 2px; }
        .val-red { color: #FF0000; }
        .code { font-size: 14px; font-weight: 800; }
        .value { font-size: 15px; margin: 1px 0; color: #000; } /* ìˆ˜ëŸ‰ì€ ê°€ë…ì„±ì„ ìœ„í•´ ê²€ì • ìœ ì§€ */
        .bg-pink { background-color: #FFD9EB; }
        .highlight { transform: translate(-50%, -50%) scale(1.2) !important; z-index: 100 !important; box-shadow: 0 4px 15px rgba(0,0,0,0.2); border: 2px solid #000 !important; background-color: #fff !important; }
        .rect.highlight { transform: scale(1.2) !important; }

        /* ì…ë ¥ UI ìŠ¤íƒ€ì¼ */
        .batch-admin-area { margin-top: 50px; padding: 25px; background: #ffffff; border: 1px solid #ddd; border-radius: 12px; width: 700px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); text-align: center; }
        .batch-admin-area h3 { margin-top: 0; color: #333; font-size: 18px; }
        .batch-admin-area textarea { width: 100%; height: 180px; margin-top: 10px; padding: 12px; font-family: 'Consolas', monospace; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; resize: vertical; background-color: #fcfcfc; }
        .update-all-btn { margin-top: 15px; padding: 12px 40px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 16px; transition: background 0.2s; }
        .update-all-btn:hover { background: #218838; }
        .hint-text { font-size: 12px; color: #888; margin-top: 8px; }
        .button-container { margin-top: 30px; display: flex; gap: 12px; }
        .filter-btn { padding: 10px 20px; cursor: pointer; border: 1px solid #ddd; background: #fff; border-radius: 8px; }
        .filter-btn.active { background: #333; color: #fff; }
    </style>
</head>
<body>

    <h1>ì¼ ì¼ ì¬ ê³  í˜„ í™© í‘œ</h1>

    <div class="grid-container" id="mainGrid">
        <div class="circle" data-pos="A101" data-type="WUR" style="top: 0%; left: 14.28%;"><span class="code">WUR</span><span class="value">1,600.000</span><span class="green-pos">A101</span></div>
        <div class="circle" data-pos="A102" data-type="WCRS" style="top: 0%; left: 28.57%;"><span class="code">WCRS</span><span class="value">1,700.557</span><span class="green-pos">A102</span></div>
        <div class="circle" data-pos="A103" data-type="WASW" style="top: 0%; left: 42.85%;"><span class="code">WASW</span><span class="value">1,360.392</span><span class="green-pos">A103</span></div>
        <div class="circle" data-pos="A104" data-type="WASWP" style="top: 0%; left: 57.14%;"><span class="code">WASWP</span><span class="value">1,403.039</span><span class="green-pos">A104</span></div>
        <div class="circle" data-pos="A105" data-type="WUR" style="top: 0%; left: 71.42%;"><span class="code">WUR</span><span class="value">1,700.915</span><span class="green-pos">A105</span></div>
        <div class="circle" data-pos="A106" data-type="WNS" style="top: 0%; left: 85.71%;"><span class="code">WNS</span><span class="value">1,637.684</span><span class="green-pos">A106</span></div>

        <div class="rect" data-pos="A201" data-type="WUSL9.0"><span class="code">WUSL9.0</span><span class="value">146.960</span><span class="green-pos">A201</span></div>
        <div class="rect" data-pos="A202" data-type="WUSH"><span class="code">WUSH</span><span class="value">420.000</span><span class="green-pos">A202</span></div>
        <div class="rect" data-pos="A203" data-type="WUR"><span class="code">WUR</span><span class="value">420.679</span><span class="green-pos">A203</span></div>
        <div class="rect" data-pos="A204" data-type="WUR"><span class="code">WUR</span><span class="value">420.233</span><span class="green-pos">A204</span></div>
        <div class="rect" data-pos="A205" data-type="WUSH"><span class="code">WUSH</span><span class="value">420.000</span><span class="green-pos">A205</span></div>
        <div class="rect" data-pos="A206" data-type="WUSL9.0"><span class="code">WUSL9.0</span><span class="value">419.860</span><span class="green-pos">A206</span></div>
        <div class="rect" data-pos="A207" data-type="WUR"><span class="code">WUR</span><span class="value">158.126</span><span class="green-pos">A207</span></div>

        <div class="circle" data-pos="A301" data-type="WUSH" style="top: 50%; left: 14.28%;"><span class="code">WUSH</span><span class="value">864.386</span><span class="green-pos">A301</span></div>
        <div class="circle" data-pos="A302" data-type="WUSH" style="top: 50%; left: 28.57%;"><span class="code">WUSH</span><span class="value">1,695.227</span><span class="green-pos">A302</span></div>
        <div class="circle" data-pos="A303" data-type="WUSH" style="top: 50%; left: 42.85%;"><span class="code">WUSH</span><span class="value">1,671.185</span><span class="green-pos">A303</span></div>
        <div class="circle" data-pos="A304" data-type="WUSH" style="top: 50%; left: 57.14%;"><span class="code">WUSH</span><span class="value">1,690.285</span><span class="green-pos">A304</span></div>
        <div class="circle" data-pos="A305" data-type="WNS" style="top: 50%; left: 71.42%;"><span class="code">WNS</span><span class="value">1,697.176</span><span class="green-pos">A305</span></div>
        <div class="circle" data-pos="A306" data-type="WUR" style="top: 50%; left: 85.71%;"><span class="code">WUR</span><span class="value">1,701.166</span><span class="green-pos">A306</span></div>

        <div class="rect" data-pos="A401" data-type="WCRS"><span class="code">WCRS</span><span class="value">170.000</span><span class="green-pos">A401</span></div>
        <div class="rect" data-pos="A402" data-type="WUSH"><span class="code">WUSH</span><span class="value">410.000</span><span class="green-pos">A402</span></div>
        <div class="rect bg-pink" data-pos="A403" data-type="WUSH"><span class="code">WUSH</span><span class="value val-red">0.000</span><span class="green-pos">A403</span></div>
        <div class="rect" data-pos="A404" data-type="WNS"><span class="code">WNS</span><span class="value">419.287</span><span class="green-pos">A404</span></div>
        <div class="rect bg-pink" data-pos="A405" data-type="WUSH"><span class="code">WUSH</span><span class="value val-red">0.000</span><span class="green-pos">A405</span></div>
        <div class="rect bg-pink" data-pos="A406" data-type="WUSH"><span class="code">WUSH</span><span class="value val-red">0.000</span><span class="green-pos">A406</span></div>
        <div class="rect" data-pos="A407" data-type="WNS"><span class="code">WNS</span><span class="value">170.000</span><span class="green-pos">A407</span></div>

        <div class="circle" data-pos="A501" data-type="WUSH" style="top: 100%; left: 14.28%;"><span class="code">WUSH</span><span class="value">1,557.437</span><span class="green-pos">A501</span></div>
        <div class="circle" data-pos="A502" data-type="WNS" style="top: 100%; left: 28.57%;"><span class="code">WNS</span><span class="value">1,703.834</span><span class="green-pos">A502</span></div>
        <div class="circle" data-pos="A503" data-type="WUSH" style="top: 100%; left: 42.85%;"><span class="code">WUSH</span><span class="value">1,645.290</span><span class="green-pos">A503</span></div>
        <div class="circle" data-pos="A504" data-type="WCRS" style="top: 100%; left: 57.14%;"><span class="code">WCRS</span><span class="value">956.294</span><span class="green-pos">A504</span></div>
        <div class="circle" data-pos="A505" data-type="WASWP" style="top: 100%; left: 71.42%;"><span class="code">WASWP</span><span class="value">1,696.740</span><span class="green-pos">A505</span></div>
        <div class="circle" data-pos="A506" data-type="WUR" style="top: 100%; left: 85.71%;"><span class="code">WUR</span><span class="value">1,700.906</span><span class="green-pos">A506</span></div>
    </div>

    <div class="batch-admin-area">
        <h3>ğŸ“‹ ë°ì´í„° ì…ë ¥ (ì—‘ì…€ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°)</h3>
        <textarea id="excelInput" placeholder="ì—¬ê¸°ì— ì—‘ì…€ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"></textarea>
        <button class="update-all-btn" onclick="applyBatchData()">í˜„í™©í‘œ ì—…ë°ì´íŠ¸</button>
        <p class="hint-text">ì…ë ¥ ì‹œ ìë™ìœ¼ë¡œ ì›í˜•ì€ íŒŒë€ìƒ‰, ì‚¬ê°í˜•ì€ ì£¼í™©ìƒ‰ ê¸€ìê°€ ì ìš©ë©ë‹ˆë‹¤.</p>
    </div>

    <div class="button-container">
        <button class="filter-btn active" onclick="highlight('ALL', this)">ëª¨ë‘ ë³´ê¸°</button>
        <button class="filter-btn" onclick="highlight('WUR', this)">WUR</button>
        <button class="filter-btn" onclick="highlight('WCRS', this)">WCRS</button>
        <button class="filter-btn" onclick="highlight('WASW', this)">WASW</button>
        <button class="filter-btn" onclick="highlight('WASWP', this)">WASWP</button>
        <button class="filter-btn" onclick="highlight('WNS', this)">WNS</button>
        <button class="filter-btn" onclick="highlight('WUSH', this)">WUSH</button>
        <button class="filter-btn" onclick="highlight('WUSL9.0', this)">WUSL9.0</button>
    </div>

    <script>
        const POS_ORDER = [
            "A101","A102","A103","A104","A105","A106",
            "A201","A202","A203","A204","A205","A206","A207",
            "A301","A302","A303","A304","A305","A306",
            "A401","A402","A403","A404","A405","A406","A407",
            "A501","A502","A503","A504","A505","A506"
        ];

        function applyBatchData() {
            const rawText = document.getElementById('excelInput').value.trim();
            if(!rawText) { alert("ë°ì´í„°ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }

            const rows = rawText.split('\n');
            let updatedCount = 0;

            rows.forEach((row, index) => {
                if(index >= POS_ORDER.length) return;
                const data = row.trim().split(/\s+/);
                if(data.length < 2) return;

                const newType = data[0].toUpperCase();
                const newVal = data[1].replace(/,/g, '');
                const pos = POS_ORDER[index];

                const target = document.querySelector(`[data-pos="${pos}"]`);
                if(target) {
                    // í’ˆëª©ëª… ì—…ë°ì´íŠ¸
                    target.querySelector('.code').innerText = newType;
                    target.setAttribute('data-type', newType);

                    // ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸
                    const valSpan = target.querySelector('.value');
                    const numVal = parseFloat(newVal);
                    if(!isNaN(numVal)) {
                        valSpan.innerText = numVal.toLocaleString(undefined, {minimumFractionDigits: 3, maximumFractionDigits: 3});
                        
                        // 0ì¼ ë•Œ ê°•ì¡° ë¡œì§ ìœ ì§€
                        if (numVal === 0) {
                            valSpan.classList.add('val-red');
                            target.classList.add('bg-pink');
                        } else {
                            valSpan.classList.remove('val-red');
                            target.classList.remove('bg-pink');
                        }
                    }
                    updatedCount++;
                }
            });
            alert(updatedCount + "ê°œì˜ ë°ì´í„°ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }

        function highlight(type, btnElement) {
            const items = document.querySelectorAll('.circle, .rect');
            items.forEach(item => item.classList.remove('highlight'));
            const btns = document.querySelectorAll('.filter-btn');
            btns.forEach(btn => btn.classList.remove('active'));
            btnElement.classList.add('active');
            if (type === 'ALL') return;
            const targets = document.querySelectorAll(`[data-type="${type}"]`);
            targets.forEach(target => { target.classList.add('highlight'); });
        }
    </script>
</body>
</html>